<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Booth Packages - BundleBooth</title>
  <style>
    :root {
      --bb-blue: #2c3e50;
      --bb-red: #e74c3c;
      --bb-light: #f8f9fa;
      --bb-dark: #343a40;
      --bb-primary: #3498db;
      --bb-secondary: #95a5a6;
      --bb-border: #e0e0e0;
      --bb-green: #27ae60;
      --bb-hover-grey: #4a5057;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: 'Poppins', sans-serif;
      line-height: 1.6;
      color: #333;
      background-color: #fff;
      padding-bottom: 40px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    h2, h3 {
      font-weight: 600;
      color: var(--bb-blue);
    }

    h2 {
      font-size: 1.8rem;
      margin-bottom: 20px;
    }

    h3 {
      font-size: 1.3rem;
      margin-bottom: 15px;
    }

    .booth-options {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-bottom: 20px;
    }

    .booth-option {
      cursor: pointer;
      padding: 8px 16px;
      background: rgba(44, 62, 80, 0.1);
      border-radius: 6px;
      font-size: 0.9rem;
      color: var(--bb-blue);
      transition: background 0.3s ease, color 0.3s ease;
    }

    .booth-option:hover {
      background: var(--bb-hover-grey);
      color: #fff;
    }

    .booth-option.active {
      background: var(--bb-dark);
      color: #fff;
      font-weight: 500;
    }

    .booth-grid {
      display: flex;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      scroll-behavior: smooth;
      gap: 30px;
      padding: 0 60px;
      position: relative;
      margin-bottom: 30px;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
      -ms-overflow-style: none;
      user-select: none;
      touch-action: pan-x;
    }

    .booth-grid::-webkit-scrollbar {
      display: none;
    }

    .booth-container {
      flex: 0 0 calc(50% - 15px);
      min-width: calc(50% - 15px);
      background: #fff;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 5px 15px rgba(0,0,0,0.05);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      border: 1px solid var(--bb-border);
      scroll-snap-align: start;
      position: relative;
    }

    .booth-container::after {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 120px;
      height: 100%;
      background: linear-gradient(to left, rgba(255,255,255,0.9), transparent);
      pointer-events: none;
      opacity: 1;
      transition: opacity 0.3s ease;
    }

    .booth-container.no-fade::after {
      opacity: 0;
    }

    .booth-container:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    }

    .image-container {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 300px;
      padding: 20px 0;
      background: linear-gradient(135deg, #FFFFFF 0%, #F5F6F5 100%);
    }

    .booth-image {
      width: 250px;
      height: 250px;
      object-fit: cover;
      border-radius: 50%;
      border: 5px solid white;
      box-shadow: 0 3px 10px rgba(192,192,192,0.3);
    }

    .booth-content {
      padding: 25px;
      padding-top: 15px;
    }

    .booth-description {
      margin-bottom: 20px;
      color: #555;
      font-size: 0.95rem;
    }

    .video-link, .backdrop-link {
      color: var(--bb-primary);
      text-decoration: none;
      font-weight: 500;
      cursor: pointer;
    }

    .video-link:hover, .backdrop-link:hover {
      text-decoration: underline;
    }

    .slideshow-container {
      position: relative;
      font-family: 'Poppins', sans-serif;
      margin-top: 20px;
    }

    .slideshow-header {
      font-size: 1.1rem;
      font-weight: 500;
      color: var(--bb-blue);
      margin-bottom: 10px;
    }

    .slide {
      display: none;
      background: #fff;
      border: 1px solid var(--bb-border);
      border-radius: 12px;
      padding: 18px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.06);
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInUp 0.6s forwards;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      touch-action: auto;
    }

    .slide.active {
      display: block;
    }

    .slide:active {
      transform: scale(0.98);
    }

    @keyframes fadeInUp {
      to { opacity: 1; transform: translateY(0); }
    }

    .slide h4 {
      margin: 0;
      color: var(--bb-blue);
      font-size: 1.1rem;
      line-height: 1.3;
    }

    .sale-tag {
      font-size: 0.6rem;
      color: var(--bb-red);
      vertical-align: super;
      font-weight: 600;
      margin-left: 4px;
      text-transform: uppercase;
    }

    .new-tag {
      font-size: 0.6rem;
      color: var(--bb-red);
      vertical-align: super;
      font-weight: 600;
      margin-left: 4px;
      text-transform: uppercase;
    }

    .slide p {
      margin: 10px 0;
      font-size: 0.9rem;
      color: #555;
      line-height: 1.5;
    }

    .slide p.description {
      margin: 10px 0;
      font-size: 0.9rem;
      color: #555;
    }

    .price {
      font-size: 1rem;
      font-weight: 600;
      color: var(--bb-red);
    }

    .price.no-sale {
      font-weight: 400;
      color: var(--bb-dark);
    }

    .original-price {
      text-decoration: line-through;
      color: var(--bb-secondary);
      font-size: 0.9rem;
      margin-left: 5px;
    }

    .discount {
      color: var(--bb-green);
      font-weight: 600;
      font-size: 0.9rem;
      margin-left: 5px;
    }

    .book-now-button {
      display: inline-block;
      margin-top: 15px;
      padding: 10px 16px;
      background: rgba(44, 62, 80, 0.1);
      color: var(--bb-blue);
      font-weight: 500;
      border-radius: 6px;
      text-decoration: none;
      font-size: 14px;
      border: none;
      cursor: pointer;
      width: 100%;
      text-align: center;
      transition: all 0.25s;
      touch-action: manipulation;
    }

    .book-now-button:hover,
    .book-now-button:focus {
      background: var(--bb-hover-grey);
      color: #fff;
      transform: translateY(-2px);
      outline: none;
    }

    .book-now-button:active {
      background: var(--bb-dark);
      color: #fff;
      transform: translateY(0);
    }

    .browse-more-button {
      display: inline-block;
      margin-top: 12px;
      padding: 10px 20px;
      background: rgba(44, 62, 80, 0.1);
      color: var(--bb-blue);
      font-weight: 500;
      border-radius: 6px;
      text-decoration: none;
      font-size: 14px;
      transition: all 0.25s;
      border: none;
      cursor: pointer;
      touch-action: manipulation;
    }

    .browse-more-button:hover {
      background: var(--bb-hover-grey);
      color: #fff;
      transform: translateY(-2px);
    }

    .browse-more-button:active {
      background: var(--bb-dark);
      color: #fff;
      transform: translateY(0);
    }

    .book-now-wrapper {
      text-align: center;
      margin-top: 12px;
    }

    .slideshow-controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin-top: 15px;
    }

    .slideshow-button {
      background: #fff;
      border: 1px solid var(--bb-border);
      border-radius: 50%;
      width: 36px;
      height: 36px;
      cursor: pointer;
      transition: all 0.25s;
      display: flex;
      align-items: center;
      justify-content: center;
      touch-action: manipulation;
    }

    .slideshow-button:hover {
      background: #f5f5f5;
      transform: scale(1.1);
    }

    .slideshow-button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .slide-indicator {
      font-size: 14px;
      color: var(--bb-dark);
      min-width: 60px;
      text-align: center;
    }

    .package-type-tag {
      display: block;
      background: #e8f4fc;
      color: var(--bb-blue);
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 0.8em;
      font-weight: 500;
      margin: 8px 0 10px 0;
      width: fit-content;
    }

    .bundled-tag {
      background: #e8fce8;
      color: #2e7d32;
      display: block;
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 0.8em;
      font-weight: 500;
      margin: 8px 0 10px 0;
      width: fit-content;
    }

    .equipment-tag {
      display: inline-block;
      background: #f0f0f0;
      color: #333;
      padding: 3px 8px;
      border-radius: 4px;
      margin: 3px;
      font-size: 14px;
      font-weight: normal;
    }

    .equipment-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin: 10px 0;
    }

    .loading {
      text-align: center;
      padding: 20px;
      color: var(--bb-secondary);
      font-style: italic;
    }

    .error-message {
      color: var(--bb-red);
      text-align: center;
      padding: 20px;
      font-weight: 500;
    }

    .package-details {
      margin: 10px 0;
    }

    .package-details p {
      margin: 5px 0;
      font-size: 0.9rem;
    }

    .price-container {
      display: flex;
      align-items: center;
      gap: 5px;
      flex-wrap: nowrap;
      white-space: nowrap;
    }

    .slideshow-note {
      font-family: 'Poppins', sans-serif;
      font-size: 0.8rem;
      color: var(--bb-secondary);
      text-align: center;
      margin: 10px 0;
    }

    @media (max-width: 900px) {
      .booth-options {
        display: none;
      }

      .booth-grid {
        display: grid;
        grid-template-columns: 1fr;
        grid-template-rows: auto;
        gap: 30px;
        padding: 0;
        overflow-x: hidden;
        scroll-snap-type: none;
        touch-action: auto;
      }

      .booth-container {
        min-width: 100%;
        max-width: 100%;
      }

      .booth-container::after {
        display: none;
      }
    }

    @media (max-width: 600px) {
      .booth-content {
        padding: 16px;
      }
      
      h2 {
        font-size: 1.5rem;
      }
      
      .booth-description {
        font-size: 0.9rem;
      }
      
      .slide h4 {
        font-size: 1rem;
        margin-bottom: 12px;
      }
      
      .slide p {
        font-size: 0.85rem;
        margin: 8px 0;
      }
      
      .image-container {
        height: 250px;
      }
      
      .booth-image {
        width: 200px;
        height: 200px;
      }

      .slide {
        padding: 16px;
      }
      
      .package-type-tag, .bundled-tag {
        font-size: 11px;
        margin: 6px 0 8px 0;
      }
      
      .equipment-tag {
        margin: 3px;
        font-size: 11px;
      }
      
      .book-now-button {
        margin-top: 12px;
      }

      .sale-tag, .new-tag {
        font-size: 0.5rem;
      }
    }
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <script type="text/javascript">
    (function (C, A, L) { 
      let p = function (a, ar) { a.q.push(ar); }; 
      let d = C.document; 
      C.Cal = C.Cal || function () { 
        let cal = C.Cal; 
        let ar = arguments; 
        if (!cal.loaded) { 
          cal.ns = {}; 
          cal.q = cal.q || []; 
          d.head.appendChild(d.createElement("script")).src = A; 
          cal.loaded = true; 
        } 
        if (ar[0] === L) { 
          const api = function () { p(api, arguments); }; 
          const namespace = ar[1]; 
          api.q = api.q || []; 
          if (typeof namespace === "string") {
            cal.ns[namespace] = cal.ns[namespace] || api;
            p(cal.ns[namespace], ar);
            p(cal, ["initNamespace", namespace]);
          } else p(cal, ar); 
          return;
        } 
        p(cal, ar); 
      }; 
    })(window, "https://app.cal.com/embed/embed.js", "init");
  </script>
</head>
<body>
  <div class="container">
    <div class="booth-options">
      <div class="booth-option active" data-booth="0">Photo Booth</div>
      <div class="booth-option" data-booth="1">360 Video Booth</div>
      <div class="booth-option" data-booth="2">Audio Guest Book</div>
      <div class="booth-option" data-booth="3">Magazine Booth</div>
    </div>
    <div class="booth-grid">
      <div class="booth-container">
        <div class="image-container">
          <img src="https://img1.wsimg.com/isteam/ip/e5031132-8c20-44e3-a810-901cf200c927/ChatGPT%2520Image%2520May%252021%252C%25202025%252C%252008_46_42%2520PM.png" alt="Photo Booth" class="booth-image">
        </div>
        <div class="booth-content">
          <h2>üì∏ Photo Booth</h2>
          <p class="booth-description">
            The photo booth experience adds a vibrant touch to any event, creating instant, tangible memories for your guests. With an array of playful props and the option for unlimited instant prints in select packages, guests can relax, have fun, and take home personalized keepsakes. It's an elegant and engaging addition that transforms every occasion into a joyful and memorable celebration.
            <br>
            <a href="http://img1.wsimg.com/isteam/ip/e5031132-8c20-44e3-a810-901cf200c927/backdrop_options_bundlebooth.png" class="backdrop-link" target="_blank">üëâ Click here to see the available backdrops we are offering.</a>
          </p>
          
          <div class="slideshow-header">Available Packages:</div>
          <div class="slideshow-container" id="photo-booth-slideshow">
            <div class="loading">Loading Photo Booth packages...</div>
          </div>
          <div class="slideshow-note">Go to Packages or tap 'Browse More' to view more options.</div>
          <div class="slideshow-controls">
            <button class="slideshow-button" id="photo-booth-prev" aria-label="Previous Slide" disabled>
              <i class="fas fa-chevron-left"></i>
            </button>
            <span class="slide-indicator" id="photo-booth-indicator">0 of 0</span>
            <button class="slideshow-button" id="photo-booth-next" aria-label="Next Slide" disabled>
              <i class="fas fa-chevron-right"></i>
            </button>
          </div>
          <div class="book-now-wrapper">
            <a href="https://rebrand.ly/ymgbgn4" target="_blank" class="browse-more-button">Browse More</a>
          </div>
        </div>
      </div>
      
      <div class="booth-container">
        <div class="image-container">
          <img src="https://img1.wsimg.com/isteam/ip/e5031132-8c20-44e3-a810-901cf200c927/May%2021%2C%202025%2C%2008_37_10%20PM.png" alt="360 Video Booth" class="booth-image">
        </div>
        <div class="booth-content">
          <h2>üé• 360 Video Booth</h2>
          <p class="booth-description">
            Elevate your event with the sophistication of our 360 Video Booth experience. Guests are invited to step onto a sleek platform as a rotating camera captures elegant, slow-motion videos from every angle. This immersive and engaging feature offers a refined touch of entertainment, creating high-quality, shareable content that leaves a lasting impression. Ideal for weddings, corporate functions, and upscale events.
            <br>
            <a href="https://player.vimeo.com/video/1092467913?h=245b7deb5d" target="_blank" class="video-link">üëâ Click here to see a sample video of the 360 experience.</a>
          </p>
          
          <div class="slideshow-header">Available Packages:</div>
          <div class="slideshow-container" id="video-booth-slideshow">
            <div class="loading">Loading 360 Video Booth packages...</div>
          </div>
          <div class="slideshow-note">Go to Packages or tap 'Browse More' to view more options.</div>
          <div class="slideshow-controls">
            <button class="slideshow-button" id="video-booth-prev" aria-label="Previous Slide" disabled>
              <i class="fas fa-chevron-left"></i>
            </button>
            <span class="slide-indicator" id="video-booth-indicator">0 of 0</span>
            <button class="slideshow-button" id="video-booth-next" aria-label="Next Slide" disabled>
              <i class="fas fa-chevron-right"></i>
            </button>
          </div>
          <div class="book-now-wrapper">
            <a href="https://rebrand.ly/ymgbgn4" target="_blank" class="browse-more-button">Browse More</a>
          </div>
        </div>
      </div>
      
      <div class="booth-container">
        <div class="image-container">
          <img src="https://img1.wsimg.com/isteam/ip/e5031132-8c20-44e3-a810-901cf200c927/blob-1481c96.png" alt="Audio Guest Book" class="booth-image">
        </div>
        <div class="booth-content">
          <h2>‚òéÔ∏è Audio Guest Book</h2>
          <p class="booth-description">
            The Audio Guest Book offers a timeless and personal way to capture heartfelt moments. Guests simply pick up the vintage-style phone and leave a message‚Äîwhether it's words of love, laughter, or well wishes. Each recording is saved as a cherished audio keepsake, allowing you to relive the voices and emotions of your special day for years to come. It's a memorable touch that adds charm and sentiment to any celebration.
          </p>
          
          <div class="slideshow-header">Available Packages:</div>
          <div class="slideshow-container" id="audio-guestbook-slideshow">
            <div class="loading">Loading Audio Guest Book packages...</div>
          </div>
          <div class="slideshow-note">Go to Packages or tap 'Browse More' to view more options.</div>
          <div class="slideshow-controls">
            <button class="slideshow-button" id="audio-guestbook-prev" aria-label="Previous Slide" disabled>
              <i class="fas fa-chevron-left"></i>
            </button>
            <span class="slide-indicator" id="audio-guestbook-indicator">0 of 0</span>
            <button class="slideshow-button" id="audio-guestbook-next" aria-label="Previous Slide" disabled>
              <i class="fas fa-chevron-right"></i>
            </button>
          </div>
          <div class="book-now-wrapper">
            <a href="https://rebrand.ly/ymgbgn4" target="_blank" class="browse-more-button">Browse More</a>
          </div>
        </div>
      </div>
      
      <div class="booth-container">
        <div class="image-container">
          <img src="https://img1.wsimg.com/isteam/ip/e5031132-8c20-44e3-a810-901cf200c927/blob-c4f551c.png" alt="Magazine Photo Booth Box" class="booth-image">
        </div>
        <div class="booth-content">
          <h2>‚≠ê Magazine Photo Booth Box</h2>
          <p class="booth-description">
            Bring the allure of a fashion magazine cover to your next event with our Magazine Photo Booth Box. Guests pose inside a life-sized, custom-branded magazine frame, instantly becoming the star of their own glamorous photo shoot. With professional lighting and a chic backdrop, this booth captures high-resolution, editorial-style portraits worthy of the front page. Give your guests a moment in the spotlight and a keepsake they'll love to share.
          </p>
          
          <div class="slideshow-header">Available Packages:</div>
          <div class="slideshow-container" id="magazine-booth-slideshow">
            <div class="loading">Loading Magazine Booth packages...</div>
          </div>
          <div class="slideshow-note">Go to Packages or tap 'Browse More' to view more options.</div>
          <div class="slideshow-controls">
            <button class="slideshow-button" id="magazine-booth-prev" aria-label="Previous Slide" disabled>
              <i class="fas fa-chevron-left"></i>
            </button>
            <span class="slide-indicator" id="magazine-booth-indicator">0 of 0</span>
            <button class="slideshow-button" id="magazine-booth-next" aria-label="Next Slide" disabled>
              <i class="fas fa-chevron-right"></i>
            </button>
          </div>
          <div class="book-now-wrapper">
            <a href="https://rebrand.ly/ymgbgn4" target="_blank" class="browse-more-button">Browse More</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      console.log('Page loaded at:', new Date().toISOString());
      const dataSource = 'https://raw.githubusercontent.com/bundlebooth/bdb-1.0/main/packages.json';
      
      const fallbackPackages = [
        {
          name: 'Sample Photo Booth Package',
          equipment: ['Photo Booth'],
          packageType: 'Individual',
          price: 500,
          description: 'A sample package for display purposes.',
          guests: 50,
          maxDuration: 2,
          slug: 'sample-photo-booth',
          Sale: 'Y',
          New: 'N'
        },
        {
          name: 'Sample Video Booth Package',
          equipment: ['360 Video Booth'],
          packageType: 'Individual',
          price: 600,
          originalPrice: 750,
          description: 'A sample video booth package.',
          guests: 75,
          maxDuration: 3,
          slug: 'sample-video-booth',
          Sale: 'Y',
          New: 'Y'
        },
        {
          name: 'Sample Audio Guest Book Package',
          equipment: ['Audio Guest Book'],
          packageType: 'Individual',
          price: 300,
          description: 'A sample audio guest book package.',
          guests: 100,
          maxDuration: 4,
          slug: 'sample-audio-guestbook',
          Sale: 'N',
          New: 'Y'
        },
        {
          name: 'Sample Magazine Booth Package',
          equipment: ['Magazine Photo Booth Box'],
          packageType: 'Individual',
          price: 700,
          originalPrice: 900,
          description: 'A sample magazine booth package.',
          guests: 80,
          maxDuration: 3,
          slug: 'sample-magazine-booth',
          Sale: 'Y',
          New: 'N'
        },
      ];

      fallbackPackages.forEach(pkg => {
        const slug = pkg.slug || `fallback-${pkg.name.toLowerCase().replace(/\s+/g, '-')}`;
        const namespace = slug;
        Cal("init", namespace, { origin: "https://app.cal.com" });
        Cal.ns[namespace]("ui", {
          "hideEventTypeDetails": false,
          "layout": "month_view"
        });
      });

      const boothGrid = document.querySelector('.booth-grid');
      const boothOptions = document.querySelectorAll('.booth-option');
      const boothContainers = document.querySelectorAll('.booth-container');

      let isDragging = false;
      let startX, scrollLeft, velocity = 0, lastTime = 0, lastX;

      function startDrag(e) {
        if (window.innerWidth <= 900) return;
        isDragging = true;
        boothGrid.style.cursor = 'grabbing';
        startX = (e.type === 'touchstart' ? e.touches[0].pageX : e.pageX) - boothGrid.offsetLeft;
        scrollLeft = boothGrid.scrollLeft;
        velocity = 0;
        lastTime = Date.now();
        lastX = startX;
        cancelMomentum();
      }

      function drag(e) {
        if (!isDragging || window.innerWidth <= 900) return;
        e.preventDefault();
        const x = (e.type === 'touchmove' ? e.touches[0].pageX : e.pageX) - boothGrid.offsetLeft;
        const walk = (x - startX) * 1.5;
        boothGrid.scrollLeft = scrollLeft - walk;

        const now = Date.now();
        const deltaTime = now - lastTime;
        if (deltaTime > 0) {
          velocity = (x - lastX) / deltaTime;
          lastX = x;
          lastTime = now;
        }
      }

      function endDrag() {
        if (!isDragging) return;
        isDragging = false;
        boothGrid.style.cursor = 'grab';
        applyMomentum();
        updateActiveOption();
      }

      let momentumId;
      function applyMomentum() {
        if (Math.abs(velocity) < 0.1) return;
        let currentScroll = boothGrid.scrollLeft;
        const momentum = velocity * 1000;

        function animate() {
          currentScroll -= velocity * 16;
          boothGrid.scrollLeft = currentScroll;
          velocity *= 0.95;
          if (Math.abs(velocity) > 0.01) {
            momentumId = requestAnimationFrame(animate);
          } else {
            snapToNearest();
          }
        }
        momentumId = requestAnimationFrame(animate);
      }

      function cancelMomentum() {
        if (momentumId) {
          cancelAnimationFrame(momentumId);
          momentumId = null;
        }
      }

      function snapToNearest() {
        const scrollLeft = boothGrid.scrollLeft;
        const containerWidth = boothContainers[0].offsetWidth + 30;
        const index = Math.round(scrollLeft / containerWidth);
        boothGrid.scrollTo({
          left: index * containerWidth,
          behavior: 'smooth'
        });
        updateActiveOption();
      }

      function updateFadeEffect() {
        if (window.innerWidth > 900) {
          const gridRect = boothGrid.getBoundingClientRect();
          boothContainers.forEach((container, index) => {
            const rect = container.getBoundingClientRect();
            const isFullyVisible = rect.left >= gridRect.left && rect.right <= gridRect.right;
            container.classList.toggle('no-fade', isFullyVisible);
            if (index === boothContainers.length - 1 && isFullyVisible) {
              container.classList.add('no-fade');
            }
          });
        }
      }

      function updateActiveOption() {
        if (window.innerWidth <= 900) return;
        const scrollLeft = boothGrid.scrollLeft;
        const containerWidth = boothContainers[0].offsetWidth + 30;
        const index = Math.round(scrollLeft / containerWidth);
        boothOptions.forEach(option => option.classList.remove('active'));
        if (boothOptions[index]) {
          boothOptions[index].classList.add('active');
        }
      }

      function scrollToBooth(index) {
        if (window.innerWidth <= 900) return;
        const booth = boothContainers[index];
        boothGrid.scrollTo({
          left: booth.offsetLeft - 30,
          behavior: 'smooth'
        });
        boothOptions.forEach(option => option.classList.remove('active'));
        boothOptions[index].classList.add('active');
      }

      function setupTouchEvents() {
        if (window.innerWidth > 900) {
          boothGrid.addEventListener('mousedown', startDrag);
          boothGrid.addEventListener('mousemove', drag);
          boothGrid.addEventListener('mouseup', endDrag);
          boothGrid.addEventListener('mouseleave', endDrag);
          boothGrid.addEventListener('touchstart', startDrag, { passive: false });
          boothGrid.addEventListener('touchmove', drag, { passive: false });
          boothGrid.addEventListener('touchend', endDrag);
        }
      }

      function removeTouchEvents() {
        boothGrid.removeEventListener('mousedown', startDrag);
        boothGrid.removeEventListener('mousemove', drag);
        boothGrid.removeEventListener('mouseup', endDrag);
        boothGrid.removeEventListener('mouseleave', endDrag);
        boothGrid.removeEventListener('touchstart', startDrag);
        boothGrid.removeEventListener('touchmove', drag);
        boothGrid.removeEventListener('touchend', endDrag);
      }

      boothOptions.forEach((option, index) => {
        option.addEventListener('click', () => {
          scrollToBooth(index);
        });
      });

      boothGrid.addEventListener('scroll', () => {
        updateFadeEffect();
        updateActiveOption();
      });

      setupTouchEvents();
      window.addEventListener('resize', () => {
        removeTouchEvents();
        setupTouchEvents();
        updateFadeEffect();
      });

      if (window.innerWidth > 900) {
        boothGrid.style.cursor = 'grab';
        boothOptions[0].classList.add('active');
        updateFadeEffect();
      }

      fetch(dataSource)
        .then(response => {
          if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status} ${response.statusText}`);
          }
          return response.json();
        })
        .then(allPackages => {
          console.log('Fetched packages:', allPackages);
          if (!Array.isArray(allPackages)) {
            throw new Error('Invalid data format: Expected an array of packages');
          }
          allPackages.forEach(pkg => {
            const slug = pkg.slug || `fallback-${pkg.name.toLowerCase().replace(/\s+/g, '-')}`;
            const namespace = slug;
            Cal("init", namespace, { origin: "https://app.cal.com" });
            Cal.ns[namespace]("ui", {
              "hideEventTypeDetails": false,
              "layout": "month_view"
            });
          });
          initSlideshows(allPackages);
        })
        .catch(error => {
          console.error('Error loading packages:', error.message);
          document.querySelectorAll('.slideshow-container').forEach(container => {
            container.innerHTML = `<div class="error-message">Failed to load packages: ${error.message}. Using fallback data.</div>`;
          });
          initSlideshows(fallbackPackages);
        });

      function initSlideshows(packages) {
        const slideshowConfigs = [
          {
            containerId: 'photo-booth-slideshow',
            prevId: 'photo-booth-prev',
            nextId: 'photo-booth-next',
            indicatorId: 'photo-booth-indicator',
            filter: 'Photo Booth'
          },
          {
            containerId: 'video-booth-slideshow',
            prevId: 'video-booth-prev',
            nextId: 'video-booth-next',
            indicatorId: 'video-booth-indicator',
            filter: '360 Video Booth'
          },
          {
            containerId: 'audio-guestbook-slideshow',
            prevId: 'audio-guestbook-prev',
            nextId: 'audio-guestbook-next',
            indicatorId: 'audio-guestbook-indicator',
            filter: 'Audio Guest Book'
          },
          {
            containerId: 'magazine-booth-slideshow',
            prevId: 'magazine-booth-prev',
            nextId: 'magazine-booth-next',
            indicatorId: 'magazine-booth-indicator',
            filter: 'Magazine Photo Booth Box'
          }
        ];

        slideshowConfigs.forEach(config => {
          initSlideshowWithFilter(
            config.containerId,
            config.prevId,
            config.nextId,
            config.indicatorId,
            packages,
            config.filter
          );
        });
      }

      function initSlideshowWithFilter(containerId, prevId, nextId, indicatorId, allPackages, equipmentFilter) {
        const container = document.getElementById(containerId);
        const prevButton = document.getElementById(prevId);
        const nextButton = document.getElementById(nextId);
        const indicator = document.getElementById(indicatorId);
        
        let currentSlide = 0;
        let filteredPackages = [];
        let slides = [];

        function filterAndSortPackages() {
          console.log(`Filtering packages for: ${equipmentFilter}`);
          filteredPackages = allPackages.filter(pkg => {
            if (!pkg.equipment || !Array.isArray(pkg.equipment)) {
              console.warn(`Package ${pkg.name} has invalid equipment field:`, pkg.equipment);
              return false;
            }
            return pkg.equipment.includes(equipmentFilter);
          }).map(pkg => ({
            ...pkg,
            originalPrice: pkg.regPrice || pkg.originalPrice || null,
            equipment: pkg.equipment ? [...pkg.equipment].sort((a, b) => {
              if (a === equipmentFilter) return -1;
              if (b === equipmentFilter) return 1;
              return a.localeCompare(b);
            }) : []
          }));

          console.log(`Filtered packages for ${equipmentFilter}:`, filteredPackages);

          filteredPackages.sort((a, b) => {
            if (a.packageType === 'Individual') {
              return -1;
            }
            if (b.packageType === 'Individual') {
              return 1;
            }
            return a.price - b.price;
          });
        }

        function calculateDiscount(price, originalPrice) {
          if (!originalPrice || originalPrice <= price || isNaN(price) || isNaN(originalPrice)) {
            return null;
          }
          const discount = ((originalPrice - price) / originalPrice) * 100;
          return Math.round(discount);
        }

        function renderSlides() {
          console.log(`Rendering slides for ${containerId}, currentSlide: ${currentSlide}`);
          
          if (filteredPackages.length === 0) {
            console.warn(`No packages found for ${equipmentFilter}`);
            container.innerHTML = '<div class="loading">No packages available for this booth type.</div>';
            slides = [];
            prevButton.disabled = true;
            nextButton.disabled = true;
            indicator.textContent = '0 of 0';
            return;
          }

          if (slides.length === 0) {
            container.innerHTML = '';
            filteredPackages.forEach((pkg, index) => {
              const packageTypeClass = pkg.packageType === 'Bundle' ? 'bundled-tag' : 'package-type-tag';
              const packageTypeDisplay = pkg.packageType === 'Bundle' ? 'Bundled' : 'Individual';
              const discount = pkg.originalPrice ? calculateDiscount(pkg.price, pkg.originalPrice) : null;
              const slug = pkg.slug || `fallback-${pkg.name.toLowerCase().replace(/\s+/g, '-')}`;
              const priceClass = discount ? 'price sale' : 'price no-sale';
              const isSale = pkg.Sale === 'Y';
              const isNew = pkg.New === 'Y';
              const statusTags = [];
              if (isSale) statusTags.push('<span class="sale-tag">ON SALE!</span>');
              if (isNew) statusTags.push('<span class="new-tag">NEW!</span>');
              
              console.log(`Creating slide for package: ${pkg.name}, Price: ${pkg.price}, OriginalPrice: ${pkg.originalPrice}, Discount: ${discount ? discount + '%' : 'None'}`);

              const slide = document.createElement('div');
              slide.className = `slide ${index === currentSlide ? 'active' : ''}`;
              const isMobile = window.innerWidth <= 900;
              const buttonTag = isMobile ? 'a' : 'button';
              const buttonAttributes = isMobile 
                ? `href="https://app.cal.com/bundleboothca/${slug}" target="_blank" rel="noopener noreferrer"`
                : `data-cal-link="bundleboothca/${slug}" data-cal-namespace="${slug}" data-cal-config='{"layout":"month_view"}'`;
              
              slide.innerHTML = `
                  <h4>${pkg.name || 'Unnamed Package'}${statusTags.join('')}</h4>
                  <div><span class="${packageTypeClass}">${packageTypeDisplay}</span></div>
                  ${pkg.description ? `<p class="description">${pkg.description}</p>` : ''}
                  <div class="package-details">
                    ${pkg.guests ? `<p><strong>Guests:</strong> Up to ${pkg.guests}</p>` : ''}
                    <p><strong>Duration:</strong> ${pkg.maxDuration ? (pkg.packageType === 'Individual' ? `${pkg.maxDuration} hours` : `Up to ${pkg.maxDuration} hours`) : 'N/A'}</p>
                    ${pkg.price ? `
                        <p><strong>Price:</strong> <span class="${priceClass}">$${pkg.price}</span>
                        ${pkg.originalPrice && discount ? ` <span class="original-price">(Reg. $${pkg.originalPrice})</span> <span class="discount">- ${discount}% OFF!</span>` : ''}
                        </p>
                      ` : ''}
                      ${pkg.equipment ? `
                        <p><strong>Services Included:</strong></p>
                        <div class="equipment-tags">
                          ${pkg.equipment.map(item => `<span class="equipment-tag">${item}</span>`).join('')}
                        </div>
                      ` : ''}
                      <${buttonTag} class="book-now-button" ${buttonAttributes}>Book Now</${buttonTag}>
                  </div>
              `;
              container.appendChild(slide);
              slides.push(slide);
            });
          } else {
            slides.forEach((slide, index) => {
              slide.classList.toggle('active', index === currentSlide);
            });
          }

          updateControls();
        }

        function updateControls() {
          prevButton.disabled = currentSlide === 0 || filteredPackages.length <= 1;
          nextButton.disabled = currentSlide === filteredPackages.length - 1 || filteredPackages.length <= 1;
          indicator.textContent = filteredPackages.length > 0 ? `${currentSlide + 1} of ${filteredPackages.length}` : '0 of 0';
        }

        prevButton.addEventListener('click', (e) => {
          e.preventDefault();
          if (currentSlide > 0) {
            currentSlide--;
            console.log(`Previous slide for ${containerId}, new currentSlide: ${currentSlide}`);
            renderSlides();
          }
        });

        nextButton.addEventListener('click', (e) => {
          e.preventDefault();
          if (currentSlide < filteredPackages.length - 1) {
            currentSlide++;
            console.log(`Next slide for ${containerId}, new currentSlide: ${currentSlide}`);
            renderSlides();
          }
        });

        window.addEventListener('resize', () => {
          renderSlides();
        });

        filterAndSortPackages();
        renderSlides();
      }
    });
  </script>
</body>
</html>
